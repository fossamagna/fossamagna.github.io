"use strict";(self.webpackChunkfossamagna_github_io=self.webpackChunkfossamagna_github_io||[]).push([[39],{1853:function(e,t,l){l.r(t),l.d(t,{Head:function(){return f},default:function(){return y}});var a=l(3366),n=l(6410),r=l(7294);function i(e){var t=Object.assign({p:"p",a:"a",div:"div",h2:"h2",code:"code",h3:"h3",ul:"ul",li:"li"},(0,n.ah)(),e.components);return r.createElement(r.Fragment,null,r.createElement(t.p,null,"以前、",r.createElement(t.a,{href:"../anatomy-of-amplify-override/"},"Amplify CDK オーバーライドってどうなってるの？"),"という記事でAmplify CDK オーバーライドがどう実装されているのか書きました。\nその時、サードパーティプラグインがオーバーライドを実装できるようになっていないこともわかりました。\nそしてamplify-cliのリポジトリでサードパーティプラグインがオーバーライドを実装できるようにする機能リクエストのIssueも出しました。"),"\n",r.createElement(t.p,null,r.createElement(t.div,{dangerouslySetInnerHTML:{__html:"<a class='gatsby-remark-link-unfurl__container' href='https:&#x2F;&#x2F;github.com&#x2F;aws-amplify&#x2F;amplify-cli&#x2F;issues&#x2F;9226' target='_blank' title='Allow third-party plugins to support CDK overrides · Issue #9226 · aws-amplify&#x2F;amplify-cli'>\n    <div class='gatsby-remark-link-unfurl__media' style='background-image: url(https:&#x2F;&#x2F;opengraph.githubassets.com&#x2F;325c757178a6fc863e3aa08b39d4911f69c62e83cb623d328aa193d9f30155d3&#x2F;aws-amplify&#x2F;amplify-cli&#x2F;issues&#x2F;9226'></div>\n    <div class='gatsby-remark-link-unfurl__content'>\n      <header class='gatsby-remark-link-unfurl__title'><p  title='Allow third-party plugins to support CDK overrides · Issue #9226 · aws-amplify&#x2F;amplify-cli'>Allow third-party plugins to support CDK overrides · Issue #9226 · aws-amplify&#x2F;amplify-cli</p></header>\n      <div class='gatsby-remark-link-unfurl__description'><p title='Is this feature request related to a new or existing Amplify category? New category Is this related to another service? No response Describe the feature you&amp;#39;d like to request Now, amplify c...'>Is this feature request related to a new or existing Amplify category? New category Is this related to another service? No response Describe the feature you&amp;#39;d like to request Now, amplify c...</p></div>\n      <footer><p title='GitHub'>GitHub</p><span title='GitHub' style='background-image: url(https:&#x2F;&#x2F;github.githubassets.com&#x2F;favicons&#x2F;favicon.svg); background-repeat: no-repeat; background-position: center center;'></span></footer>\n    </div>\n    </a>\n  "}})),"\n",r.createElement(t.p,null,"後日、Pull Requestを出しましたが、最近やっとそれがマージされ",r.createElement(t.a,{href:"https://github.com/aws-amplify/amplify-cli/releases/tag/v8.4.0"},"amplify-cli@8.4.0"),"としてリリースされたので概要を書きたいと思います。\nPull Requestを作成してからマージまで5ヶ月くらいかかりました。。。"),"\n",r.createElement(t.p,null,r.createElement(t.div,{dangerouslySetInnerHTML:{__html:"<a class='gatsby-remark-link-unfurl__container' href='https:&#x2F;&#x2F;github.com&#x2F;aws-amplify&#x2F;amplify-cli&#x2F;pull&#x2F;9601' target='_blank' title='Allow 3rd-party plugin to CDK override by fossamagna · Pull Request #9601 · aws-amplify&#x2F;amplify-cli'>\n    <div class='gatsby-remark-link-unfurl__media' style='background-image: url(https:&#x2F;&#x2F;opengraph.githubassets.com&#x2F;7683ce4b22c92036fc999eb5683c2826cf3d01e677beea7d3cf11d2cd0bc52f9&#x2F;aws-amplify&#x2F;amplify-cli&#x2F;pull&#x2F;9601'></div>\n    <div class='gatsby-remark-link-unfurl__content'>\n      <header class='gatsby-remark-link-unfurl__title'><p  title='Allow 3rd-party plugin to CDK override by fossamagna · Pull Request #9601 · aws-amplify&#x2F;amplify-cli'>Allow 3rd-party plugin to CDK override by fossamagna · Pull Request #9601 · aws-amplify&#x2F;amplify-cli</p></header>\n      <div class='gatsby-remark-link-unfurl__description'><p title='Description of changes\nAllow 3rd-party plugin to CDK override. Some restricted points to starts with @aws-amplify&#x2F;amplify-category- literal changed to use package location in pluginInfo.\n\nIssue #, ...'>Description of changes\nAllow 3rd-party plugin to CDK override. Some restricted points to starts with @aws-amplify&#x2F;amplify-category- literal changed to use package location in pluginInfo.\n\nIssue #, ...</p></div>\n      <footer><p title='GitHub'>GitHub</p><span title='GitHub' style='background-image: url(https:&#x2F;&#x2F;github.githubassets.com&#x2F;favicons&#x2F;favicon.svg); background-repeat: no-repeat; background-position: center center;'></span></footer>\n    </div>\n    </a>\n  "}})),"\n",r.createElement(t.h2,{id:"何が変わったか"},"何が変わったか？"),"\n",r.createElement(t.p,null,r.createElement(t.a,{href:"../anatomy-of-amplify-override/"},"以前の記事"),"でも触れましたが、\nAmplify CDK オーバーライドを使うと",r.createElement(t.code,null,"override.ts"),"というファイルでCDKのAPIを利用してAmplify(の対象のカテゴリー)が提要する機能をオーバーライドできます。\n",r.createElement(t.code,null,"override.ts"),"に記述した内容は",r.createElement(t.code,null,"amplify push"),"を実行するとその内容が最終的にCloud Formationのテンプレートとその入力パラメーターとなる",r.createElement(t.code,null,"parameters.jons"),"に変換されてデプロイされます。"),"\n",r.createElement(t.p,null,"以前は",r.createElement(t.code,null,"amplify push"),"の時に実行されるCloud Formationのテンプレートの生成の処理が",r.createElement(t.code,null,"@aws-amplify"),"のパッケージスコープに限定されていましたが、\n今回のPull Requestがマージされてからは、",r.createElement(t.code,null,"amplify push"),"のライフサイクルで全てのカテゴリープラグインの",r.createElement(t.code,null,"transformCategoryStack"),"関数を呼び出してもらえるようになりました。\nこの関数を実装すれば公式プラグイン(",r.createElement(t.code,null,"amplify-category-api"),"など)と同じCDKオーバーライドの機能を提供できるようになりました。"),"\n",r.createElement(t.p,null,"ざっくりまとめると、以下のようになります。"),"\n",r.createElement(t.h3,{id:"amplify-cliから提供されるもの"},"amplify-cliから提供されるもの"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,r.createElement(t.code,null,"transformCategoryStack"),"関数を実装してamplify-cliが提供するライフサイクルをフックできる"),"\n",r.createElement(t.li,null,r.createElement(t.code,null,"cli-inputs.json"),"のバリデーション"),"\n"),"\n",r.createElement(t.h3,{id:"amplify-cliから提供されないものプラグインが実装するもの"},"amplify-cliから提供されないもの(プラグインが実装するもの)"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,r.createElement(t.code,null,"override.ts"),"のトランスパイル(",r.createElement(t.code,null,"override.js"),"の生成)"),"\n",r.createElement(t.li,null,r.createElement(t.code,null,"override.js"),"の実行(Cfnテンプレートの生成)"),"\n"),"\n",r.createElement(t.h2,{id:"まとめ"},"まとめ"),"\n",r.createElement(t.p,null,"サードパーティプラグインでもCDKオーバーライドの機能が提供できるようになりました。\n実際にどう実装すると良いのかはまた別記事で紹介したいと思います。"))}var s=function(e){void 0===e&&(e={});var t=Object.assign({},(0,n.ah)(),e.components).wrapper;return t?r.createElement(t,e,r.createElement(i,e)):i(e)},o=l(1597),c=l(8771),u=l(5297),m=l(746),p=["data"],f=function(e){var t=e.data,l=(0,a.Z)(e,p),n=t.mdx;return r.createElement(m.F,Object.assign({data:t,title:n.frontmatter.title,description:n.frontmatter.description||n.excerpt},l))},d=function(e){var t,l=e.data,a=e.location,n=e.children,i=l.mdx,s=(null===(t=l.site.siteMetadata)||void 0===t?void 0:t.title)||"Title",m=l.previous,p=l.next;return r.createElement(u.Z,{location:a,title:s},r.createElement("article",{className:"blog-post",itemScope:!0,itemType:"http://schema.org/Article"},r.createElement("header",null,r.createElement("h1",{itemProp:"headline"},i.frontmatter.title),r.createElement("p",null,i.frontmatter.date)),n,r.createElement("hr"),r.createElement("footer",null,r.createElement(c.Z))),r.createElement("nav",{className:"blog-post-nav"},r.createElement("ul",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",listStyle:"none",padding:0}},r.createElement("li",null,m&&r.createElement(o.Link,{to:m.fields.slug,rel:"prev"}," ← ",m.frontmatter.title)),r.createElement("li",null,p&&r.createElement(o.Link,{to:p.fields.slug,rel:"next"},p.frontmatter.title," →")))))};function y(e){return r.createElement(d,e,r.createElement(s,e))}},3366:function(e,t,l){function a(e,t){if(null==e)return{};var l,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)l=r[a],t.indexOf(l)>=0||(n[l]=e[l]);return n}l.d(t,{Z:function(){return a}})}}]);
//# sourceMappingURL=component---src-templates-blog-post-js-content-file-path-home-runner-work-fossamagna-github-io-fossamagna-github-io-content-blog-allow-3rd-party-plugin-to-amplify-override-index-mdx-e106553bb6ced7401e9e.js.map