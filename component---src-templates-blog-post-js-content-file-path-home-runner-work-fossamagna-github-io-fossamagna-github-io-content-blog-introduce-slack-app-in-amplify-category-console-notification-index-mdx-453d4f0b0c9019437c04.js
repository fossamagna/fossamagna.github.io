"use strict";(self.webpackChunkfossamagna_github_io=self.webpackChunkfossamagna_github_io||[]).push([[105],{4287:function(e,a,t){t.r(a),t.d(a,{Head:function(){return g},default:function(){return u}});var n=t(3366),l=t(6410),c=t(7294);function o(e){var a=Object.assign({h1:"h1",p:"p",a:"a",ul:"ul",li:"li",div:"div",em:"em",sup:"sup",code:"code",section:"section",h2:"h2",ol:"ol"},(0,l.ah)(),e.components);return c.createElement(c.Fragment,null,c.createElement(a.h1,{id:"amplify-consoleのslackアプリ"},"Amplify ConsoleのSlackアプリ"),"\n",c.createElement(a.p,null,"Amplify Consoleのビルト結果をSlackに通知するAmplifyプラグインとして",c.createElement(a.a,{href:"https://github.com/fossamagna/amplify-category-console-notification"},"amplify-category-console-notification"),"を公開しています。\n最近、このプラグインにSlackアプリを追加しました。"),"\n",c.createElement(a.p,null,c.createElement(a.a,{href:"https://github.com/fossamagna/amplify-category-console-notification"},"amplify-category-console-notification"),"のSlackアプリを追加すると次のことができるようになります。"),"\n",c.createElement(a.ul,null,"\n",c.createElement(a.li,null,"Amplify Consoleのビルド開始・終了時にSlackメッセージで通知を受け取る"),"\n",c.createElement(a.li,null,"Slackメッセージからそのバージョンを再デプロイする"),"\n",c.createElement(a.li,null,"SlackメッセージからAmplify Consoleのビルドをキャンセルする"),"\n"),"\n",c.createElement(a.p,null,c.createElement(a.div,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1030px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/049d6f2c6aa329ce8b763819ec79a466/7a1fb/slack-app-messages.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 61.875%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABs0lEQVQoz5WSSY7TQBhGcwGQWiDieCjPiYfETnl2bJOkJQYJCRohRKu3iHOw5g4cAS7AmmNwEjYPxd1q2NBJLz7VokqvvvpfTfphy49vX7h4+4ayGSibjqxsqNoemdess5JFlGB5ATPNRNUtZndksh16fn7/zIf3r8nLDW03sOm3lFVLKkuyoiLKatS4QD0ADWuE/i8TRTN5+FjghimxLEmymm7/nKLboVr+P7ebd4JugaphI0wL1Y2YBhmKt2S6kChBhjpPrg8a9tFmt8CpKnhw9gRd2EhZ4PkBU0VDmekoMwNFE2O7mX4icBGtuLx8h8wrElkSJxJvERHEKfNwiR8sMW0PQ9gnQSevXr7g96+vfPp4RdOfj0I2w5623yLLDVW9YZU3iDhnponjUlx/wfl+R1HVpOucpu0Znu5ouy0XzwbCMMb0QhQnPO3JB8tnjxRUf4m+qtGCFLFusWRHIIux1WGOqnYPy5qwEc6cMMmYxylemOBHKYYTXM9ttHxj+kgmB+qhpbA9ZFaxWufEqzVJmuP6wY3lv3/xWCaacLDcOabjo5sOuuliWO64Ctsf9+6TP8w6WgmdJAcnAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="Slackに通知されるメッセージ"\n        title="Slackに通知されるメッセージ"\n        src="/static/049d6f2c6aa329ce8b763819ec79a466/7a1fb/slack-app-messages.png"\n        srcset="/static/049d6f2c6aa329ce8b763819ec79a466/72799/slack-app-messages.png 320w,\n/static/049d6f2c6aa329ce8b763819ec79a466/6af66/slack-app-messages.png 640w,\n/static/049d6f2c6aa329ce8b763819ec79a466/7a1fb/slack-app-messages.png 1030w"\n        sizes="(max-width: 1030px) 100vw, 1030px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n  </a>\n    </span>'}}),"\n",c.createElement(a.em,null,"Slackに通知されたビルド結果")),"\n",c.createElement(a.p,null,"このSlackアプリを追加する以前は、",c.createElement(a.a,{href:"https://api.slack.com/messaging/webhooks#getting_started"},"SlackのIncoming Webhook"),"（以降、Webhook版）を利用してSlackにビルド結果のメッセージを送信していました。\nWebhook版はシンプルな構成でビルド結果の通知ができていましが、ビルドに対するアクションもSlack上からできると便利だと思い、Slackアプリ版を追加しました",c.createElement(a.sup,null,c.createElement(a.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label"},"1")),"。"),"\n",c.createElement(a.h1,{id:"slackアプリを追加する"},"Slackアプリを追加する"),"\n",c.createElement(a.p,null,"Slackアプリを追加（利用）するには、Amplifyプロジェクトで次のコマンドを実行して",c.createElement(a.a,{href:"https://github.com/fossamagna/amplify-category-console-notification"},"amplify-category-console-notification"),"をインストールします。"),"\n",c.createElement(a.div,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="console"><pre class="language-console"><code class="language-console">npm install -g amplify-category-console-notification amplify-slack-nodejs-function-template-provider\namplify plugin add $(npm root -g)/amplify-category-console-notification</code></pre></div>'}}),"\n",c.createElement(a.p,null,"インストールできたら、以下のコマンドでSlackアプリ追加を開始します。"),"\n",c.createElement(a.div,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="console"><pre class="language-console"><code class="language-console">amplify add console-notification</code></pre></div>'}}),"\n",c.createElement(a.p,null,"コマンドを実行すると、Webhook版とSlackアプリ版のどちらを使うのか聞かれるのでSlackアプリを選択します。\nSlackアプリを選択すると、Slackアプリを追加するの必要な手順がコンソールに表示されます。スクリーンキャプチャ付きのドキュメントのURLがコンソールに表示され、ブラウザでそのページが表示されるので、その手順に沿ってSlack APIのページでSlack Appを作成してください。実際の手順は",c.createElement(a.a,{href:"https://github.com/fossamagna/amplify-category-console-notification/blob/main/packages/amplify-slack-app/docs/SETUP.md"},"こちら"),"から確認できます。"),"\n",c.createElement(a.p,null,c.createElement(a.div,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1280px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/1b7587ab1eef93506527128ef67a35de/9c701/add-slack-app.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 32.8125%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABMUlEQVQoz3WRyW6DMBRF+Y8whgRibGygMfPMJhLpLv3/T7mVX5tKUdvF0bUX7+lc25qmCfM8Y1lW6GGCKmuchMRZSLD8DbHMwLICSXGFHzPY4Rn2KYLjuHAc5xeW1hqCc3AhwITAJeFIUokLF3CDI/wwfME7fmUQBPB9n/KJ53mwlmXBtm0wpiudV8zGepowDgPyLIOSEplSRJHnyPMMjDHEcUxpSJIEYRjC6vsewzCgbVvUdU10XYemrrCuK5RSiKKIBp6DxuRwOMC27Reo8tD3KMuSlpil0zjiqjVSXUJIBS88wXVdWvKsZu7/YX08Hrjdbrjf78S+71j2d6LtOog0JUNTxxgYs7/4MRzHkcyapqEsqwpFWUF/19f6iqqqCPOBnHMIISClpLMhTVNK84afpK3VOGM9BcYAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="Slackアプリ追加"\n        title="Slackアプリ追加"\n        src="/static/1b7587ab1eef93506527128ef67a35de/21b4d/add-slack-app.png"\n        srcset="/static/1b7587ab1eef93506527128ef67a35de/72799/add-slack-app.png 320w,\n/static/1b7587ab1eef93506527128ef67a35de/6af66/add-slack-app.png 640w,\n/static/1b7587ab1eef93506527128ef67a35de/21b4d/add-slack-app.png 1280w,\n/static/1b7587ab1eef93506527128ef67a35de/9c701/add-slack-app.png 1774w"\n        sizes="(max-width: 1280px) 100vw, 1280px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n  </a>\n    </span>'}}),"\n",c.createElement(a.em,null,"コンソールに表示されたSlackアプリを追加するの必要な手順")),"\n",c.createElement(a.p,null,"Slack Appを作成すると、Slack APIのページで以下の値を確認できるようになります。コンソールのプロンプトでそれらの値の入力を求められるので入力してください",c.createElement(a.sup,null,c.createElement(a.a,{href:"#user-content-fn-2",id:"user-content-fnref-2","data-footnote-ref":!0,"aria-describedby":"footnote-label"},"2")),"。"),"\n",c.createElement(a.ul,null,"\n",c.createElement(a.li,null,c.createElement(a.code,null,"Signing Secret")),"\n",c.createElement(a.li,null,c.createElement(a.code,null,"Slack Bot User OAuth Token")),"\n",c.createElement(a.li,null,c.createElement(a.code,null,"Slack Channel ID")),"\n"),"\n",c.createElement(a.p,null,"全て入力が完了したら、追加されたサービスのリソースをAWS上に作成します。\n",c.createElement(a.code,null,"amplify push"),"するか、すでにAmplify Consoleと連携済みであれば",c.createElement(a.code,null,"git commit"),"＆",c.createElement(a.code,null,"git push"),"をすることで実行できます。\nこれ以降は、Amplify Consoleでビルドする度に、Slackに通知のメッセージが送信されるようになります。"),"\n",c.createElement(a.h1,{id:"フィードバックのお願い"},"フィードバックのお願い"),"\n",c.createElement(a.p,null,"Amplifyユーザーの方に使っていただいてフィードバックをいただけると嬉しいです。バグ報告や改善提案など",c.createElement(a.a,{href:"https://github.com/fossamagna/amplify-category-console-notification/issues/new/choose"},"GitHubのIssue"),"、",c.createElement(a.a,{href:"https://twitter.com/fossamagna"},"Twitter"),"、",c.createElement(a.a,{href:"https://github.com/aws-amplify-jp/awesome-aws-amplify-ja#slack"},"Amplify Japan User GroupのSlack"),"などでお待ちしています。"),"\n",c.createElement(a.section,{"data-footnotes":!0,className:"footnotes"},c.createElement(a.h2,{className:"sr-only",id:"footnote-label"},"脚注"),"\n",c.createElement(a.ol,null,"\n",c.createElement(a.li,{id:"user-content-fn-1"},"\n",c.createElement(a.p,null,"Slackアプリ版を追加しましたが、Incoming Webhook版も引き続き利用可能です。 ",c.createElement(a.a,{href:"#user-content-fnref-1","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content"},"↩")),"\n"),"\n",c.createElement(a.li,{id:"user-content-fn-2"},"\n",c.createElement(a.p,null,"入力されたシークレット、トークンはAWS SSMに保存されます。 ",c.createElement(a.a,{href:"#user-content-fnref-2","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content"},"↩")),"\n"),"\n"),"\n"))}var i=function(e){void 0===e&&(e={});var a=Object.assign({},(0,l.ah)(),e.components).wrapper;return a?c.createElement(a,e,c.createElement(o,e)):o(e)},s=t(1597),r=t(8771),m=t(5297),p=t(746),f=["data"],g=function(e){var a=e.data,t=(0,n.Z)(e,f),l=a.mdx;return c.createElement(p.F,Object.assign({data:a,title:l.frontmatter.title,description:l.frontmatter.description||l.excerpt},t))},d=function(e){var a,t=e.data,n=e.location,l=e.children,o=t.mdx,i=(null===(a=t.site.siteMetadata)||void 0===a?void 0:a.title)||"Title",p=t.previous,f=t.next;return c.createElement(m.Z,{location:n,title:i},c.createElement("article",{className:"blog-post",itemScope:!0,itemType:"http://schema.org/Article"},c.createElement("header",null,c.createElement("h1",{itemProp:"headline"},o.frontmatter.title),c.createElement("p",null,o.frontmatter.date)),l,c.createElement("hr"),c.createElement("footer",null,c.createElement(r.Z))),c.createElement("nav",{className:"blog-post-nav"},c.createElement("ul",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",listStyle:"none",padding:0}},c.createElement("li",null,p&&c.createElement(s.Link,{to:p.fields.slug,rel:"prev"}," ← ",p.frontmatter.title)),c.createElement("li",null,f&&c.createElement(s.Link,{to:f.fields.slug,rel:"next"},f.frontmatter.title," →")))))};function u(e){return c.createElement(d,e,c.createElement(i,e))}},3366:function(e,a,t){function n(e,a){if(null==e)return{};var t,n,l={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||(l[t]=e[t]);return l}t.d(a,{Z:function(){return n}})}}]);
//# sourceMappingURL=component---src-templates-blog-post-js-content-file-path-home-runner-work-fossamagna-github-io-fossamagna-github-io-content-blog-introduce-slack-app-in-amplify-category-console-notification-index-mdx-453d4f0b0c9019437c04.js.map